race_participation <- c(round(sum(100 * global_asian_participation$Asian_participants) /
sum(global_asian_participation$Enrollment), 0),
round(sum(100 * global_black_participation$Black_participants) /
sum(global_black_participation$Enrollment), 0),
round(sum(100 * global_white_participation$White_participants) /
sum(global_white_participation$Enrollment), 0))
#fda_snapshots <- c(11, 7, 76)
races <- c("Asian", "Black", "White")
#Race_distribution_comparison <- data.frame(races, fda_snapshots, demographic_participation)
#names(Race_distribution_comparison) <- c("Race", "FDA_Snapshots", "Our_Database")
Race_participation <- data.frame("Race", races, race_participation)
names(Race_participation) <- c("Demographic", "Race", "Value")
View(Race_participation)
names(Race_participation) <- c("Demographic", "Category", "Value")
View(Race_participation)
Race_distribution_comparison_graph <- Race_participation %>%
pivot_longer(cols = Value, names_to = "Database", values_to = "Participation") %>%
ggplot(aes(Race, Participation, width = 0.5)) + #, fill = Database)) +
geom_bar(stat = "identity", position = 'dodge') +
geom_text(aes(label=Participation), position = position_dodge(0.9), vjust=-0.3, size=6) +
ylim(0,100) +
xlab("Race") +
ylab("Participation") +
#theme(text = element_text(size=15), axis.text.x = element_text(size=15)) +
theme(axis.title.x=element_text(size=12, face="bold"), axis.title.y=element_text(size=12, face="bold")) +
ggtitle("Race distribution of trial participants")
Race_distribution_comparison_graph
runApp()
library(shiny)
library(tidyverse)
library(lubridate)
library(dplyr)
library(scales)
library(RColorBrewer)
library(plotly)
#library(kableExtra)
# Read in the data
print( "Loading data ..." )
fda_approvals <- read.csv('FDA_Drug_Trials_Snapshots_2015-20.csv')
disease_burden <- read.csv('Disease_burden.csv')
print( "Data loaded!" )
# Change class type of select variables to aid in data processing and visualization
fda_approvals$Enrollment <- as.numeric(as.character(fda_approvals$Enrollment))
fda_approvals$Therapeutic_Area <- as.character(fda_approvals$Therapeutic_Area)
fda_approvals$Brand_Name <- as.character(fda_approvals$Brand_Name)
fda_approvals$United_States <- as.numeric(as.character(fda_approvals$United_States))
# Add columns for non-hispanic, Men, Age under 65
fda_approvals <- fda_approvals %>% mutate(Non_Hispanic = 100 - Hispanic, .after = Hispanic)
fda_approvals <- fda_approvals %>% mutate(Male = 100 - Female, .after = Female)
fda_approvals <- fda_approvals %>% mutate(Age_under_65 = 100 - Age_65_or_older, .after = Age_65_or_older)
# Create longer version, for plotting
fda_approvals_long <- pivot_longer(fda_approvals, cols = Women:Age_80_or_older, names_to = "Demographic", values_to = "Percentage")
library(shiny)
library(tidyverse)
library(lubridate)
library(dplyr)
library(scales)
library(RColorBrewer)
library(plotly)
#library(kableExtra)
# Read in the data
print( "Loading data ..." )
fda_approvals <- read.csv('FDA_Drug_Trials_Snapshots_2015-20.csv')
disease_burden <- read.csv('Disease_burden.csv')
print( "Data loaded!" )
# Change class type of select variables to aid in data processing and visualization
fda_approvals$Enrollment <- as.numeric(as.character(fda_approvals$Enrollment))
fda_approvals$Therapeutic_Area <- as.character(fda_approvals$Therapeutic_Area)
fda_approvals$Brand_Name <- as.character(fda_approvals$Brand_Name)
fda_approvals$United_States <- as.numeric(as.character(fda_approvals$United_States))
# Add columns for non-hispanic, Men, Age under 65
fda_approvals <- fda_approvals %>% mutate(Non_Hispanic = 100 - Hispanic, .after = Hispanic)
fda_approvals <- fda_approvals %>% mutate(Male = 100 - Female, .after = Female)
fda_approvals <- fda_approvals %>% mutate(Age_under_65 = 100 - Age_65_or_older, .after = Age_65_or_older)
# Create longer version, for plotting
fda_approvals_long <- pivot_longer(fda_approvals, cols = Female:Age_80_or_older, names_to = "Demographic", values_to = "Percentage")
# Change class type of variable in long
fda_approvals_long$Percentage <- as.numeric(as.character(fda_approvals_long$Percentage))
# Make 15-19 dataset
approvals_15_19 <- fda_approvals %>% filter(Approval_Year != 2020)
global_female_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Female) %>%
filter(Female != "NA") %>%
mutate(Female_participants = (Female/100) * Enrollment)
global_male_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Male) %>%
filter(Male != "NA") %>%
mutate(Male_participants = (Male/100) * Enrollment)
sex_participation <- c(round(sum(100 * global_female_participation$Female_participants) /
sum(global_female_participation$Enrollment), 0),
round(sum(100 * global_male_participation$Male_participants) /
sum(global_male_participation$Enrollment), 0))
global_black_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Black) %>%
filter(Black != "NA") %>%
mutate(Black_participants = (Black/100) * Enrollment)
global_white_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, White) %>%
filter(White != "NA") %>%
mutate(White_participants = (White/100) * Enrollment)
global_asian_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Asian) %>%
filter(Asian != "NA") %>%
mutate(Asian_participants = (Asian/100) * Enrollment)
race_participation <- c(round(sum(100 * global_asian_participation$Asian_participants) /
sum(global_asian_participation$Enrollment), 1),
round(sum(100 * global_black_participation$Black_participants) /
sum(global_black_participation$Enrollment), 1),
round(sum(100 * global_white_participation$White_participants) /
sum(global_white_participation$Enrollment), 1))
races <- c("Asian", "Black", "White")
Race_participation <- data.frame("Race", races, race_participation)
names(Race_participation) <- c("Demographic", "Category", "Value")
# Sex
global_female_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Female) %>%
filter(Female != "NA") %>%
mutate(Female_participants = (Female/100) * Enrollment)
global_male_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Male) %>%
filter(Male != "NA") %>%
mutate(Male_participants = (Male/100) * Enrollment)
sex_participation <- c(round(sum(100 * global_female_participation$Female_participants) /
sum(global_female_participation$Enrollment), 1),
round(sum(100 * global_male_participation$Male_participants) /
sum(global_male_participation$Enrollment), 1))
# Race
global_black_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Black) %>%
filter(Black != "NA") %>%
mutate(Black_participants = (Black/100) * Enrollment)
global_white_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, White) %>%
filter(White != "NA") %>%
mutate(White_participants = (White/100) * Enrollment)
global_asian_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Asian) %>%
filter(Asian != "NA") %>%
mutate(Asian_participants = (Asian/100) * Enrollment)
race_participation <- c(round(sum(100 * global_asian_participation$Asian_participants) /
sum(global_asian_participation$Enrollment), 0),
round(sum(100 * global_black_participation$Black_participants) /
sum(global_black_participation$Enrollment), 0),
round(sum(100 * global_white_participation$White_participants) /
sum(global_white_participation$Enrollment), 0))
races <- c("Asian", "Black", "White")
Race_participation <- data.frame("Race", races, race_participation)
names(Race_participation) <- c("Demographic", "Category", "Value")
# Sex
global_female_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Female) %>%
filter(Female != "NA") %>%
mutate(Female_participants = (Female/100) * Enrollment)
global_male_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Male) %>%
filter(Male != "NA") %>%
mutate(Male_participants = (Male/100) * Enrollment)
sex_participation <- c(round(sum(100 * global_female_participation$Female_participants) /
sum(global_female_participation$Enrollment), 0),
round(sum(100 * global_male_participation$Male_participants) /
sum(global_male_participation$Enrollment), 0))
global_Age_under_65_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Age_under_65) %>%
filter(Age_under_65 != "NA") %>%
mutate(Age_under_65_participants = (Age_under_65/100) * Enrollment)
global_Age_65_or_older_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Age_65_or_older) %>%
filter(Age_65_or_older != "NA") %>%
mutate(Age_65_or_older_participants = (Age_65_or_older/100) * Enrollment)
sex_participation <- c(round(sum(100 * global_Age_under_65_participation$Age_under_65_participants) /
sum(global_Age_under_65_participation$Enrollment), 0),
round(sum(100 * global_Age_65_or_older_participation$Age_65_or_older_participants) /
sum(global_Age_65_or_older_participation$Enrollment), 0))
global_female_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Female) %>%
filter(Female != "NA") %>%
mutate(Female_participants = (Female/100) * Enrollment)
global_male_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Male) %>%
filter(Male != "NA") %>%
mutate(Male_participants = (Male/100) * Enrollment)
sex_participation <- c(round(sum(100 * global_female_participation$Female_participants) /
sum(global_female_participation$Enrollment), 0),
round(sum(100 * global_male_participation$Male_participants) /
sum(global_male_participation$Enrollment), 0))
# Age
global_Age_under_65_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Age_under_65) %>%
filter(Age_under_65 != "NA") %>%
mutate(Age_under_65_participants = (Age_under_65/100) * Enrollment)
global_Age_65_or_older_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Age_65_or_older) %>%
filter(Age_65_or_older != "NA") %>%
mutate(Age_65_or_older_participants = (Age_65_or_older/100) * Enrollment)
age_participation <- c(round(sum(100 * global_Age_under_65_participation$Age_under_65_participants) /
sum(global_Age_under_65_participation$Enrollment), 0),
round(sum(100 * global_Age_65_or_older_participation$Age_65_or_older_participants) /
sum(global_Age_65_or_older_participation$Enrollment), 0))
## Account for missing data. Capture % representation of each demographic only in trials where that demographic is captured
# Race
global_black_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Black) %>%
filter(Black != "NA") %>%
mutate(Black_participants = (Black/100) * Enrollment)
global_white_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, White) %>%
filter(White != "NA") %>%
mutate(White_participants = (White/100) * Enrollment)
global_asian_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Asian) %>%
filter(Asian != "NA") %>%
mutate(Asian_participants = (Asian/100) * Enrollment)
race_participation <- c(round(sum(100 * global_asian_participation$Asian_participants) /
sum(global_asian_participation$Enrollment), 0),
round(sum(100 * global_black_participation$Black_participants) /
sum(global_black_participation$Enrollment), 0),
round(sum(100 * global_white_participation$White_participants) /
sum(global_white_participation$Enrollment), 0))
races <- c("Asian", "Black", "White")
race_participation <- data.frame("Race", races, race_participation)
names(Race_participation) <- c("Demographic", "Category", "Value")
# Sex
global_female_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Female) %>%
filter(Female != "NA") %>%
mutate(Female_participants = (Female/100) * Enrollment)
global_male_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Male) %>%
filter(Male != "NA") %>%
mutate(Male_participants = (Male/100) * Enrollment)
sex_participation <- c(round(sum(100 * global_female_participation$Female_participants) /
sum(global_female_participation$Enrollment), 0),
round(sum(100 * global_male_participation$Male_participants) /
sum(global_male_participation$Enrollment), 0))
sexes <- c("Female", "Male")
sex_participation <- data.frame("Sex", sexes, sex_participation)
names(sex_participation) <- c("Demographic", "Category", "Value")
# Age
global_Age_under_65_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Age_under_65) %>%
filter(Age_under_65 != "NA") %>%
mutate(Age_under_65_participants = (Age_under_65/100) * Enrollment)
global_Age_65_or_older_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Age_65_or_older) %>%
filter(Age_65_or_older != "NA") %>%
mutate(Age_65_or_older_participants = (Age_65_or_older/100) * Enrollment)
age_participation <- c(round(sum(100 * global_Age_under_65_participation$Age_under_65_participants) /
sum(global_Age_under_65_participation$Enrollment), 0),
round(sum(100 * global_Age_65_or_older_participation$Age_65_or_older_participants) /
sum(global_Age_65_or_older_participation$Enrollment), 0))
ages <- c("Age_under_65", "Age_65_or_older")
age_participation <- data.frame("Age", ages, age_participation)
names(age_participation) <- c("Demographic", "Category", "Value")
#fda_approvals <- fda_approvals %>% mutate(Age_under_65 = 100 - Age_65_or_older, .after = Age_65_or_older)
View(age_participation)
View(sex_participation)
View(race_participation)
demographic_participation <- data.frame(age_participation, sex_participation, race_participation)
demographic_participation <- cbind(age_participation, sex_participation, race_participation)
demographic_participation <- rbind(age_participation, sex_participation, race_participation)
demographic_participation <- c(age_participation, sex_participation, race_participation)
View(demographic_participation)
demographic_participation <- rbind(age_participation, sex_participation)
View(demographic_participation)
library(shiny)
library(tidyverse)
library(lubridate)
library(dplyr)
library(scales)
library(RColorBrewer)
library(plotly)
#library(kableExtra)
# Read in the data
print( "Loading data ..." )
fda_approvals <- read.csv('FDA_Drug_Trials_Snapshots_2015-20.csv')
disease_burden <- read.csv('Disease_burden.csv')
print( "Data loaded!" )
# Change class type of select variables to aid in data processing and visualization
fda_approvals$Enrollment <- as.numeric(as.character(fda_approvals$Enrollment))
fda_approvals$Therapeutic_Area <- as.character(fda_approvals$Therapeutic_Area)
fda_approvals$Brand_Name <- as.character(fda_approvals$Brand_Name)
fda_approvals$United_States <- as.numeric(as.character(fda_approvals$United_States))
# Add columns for non-hispanic, Men, Age under 65
fda_approvals <- fda_approvals %>% mutate(Non_Hispanic = 100 - Hispanic, .after = Hispanic)
fda_approvals <- fda_approvals %>% mutate(Male = 100 - Female, .after = Female)
fda_approvals <- fda_approvals %>% mutate(Age_under_65 = 100 - Age_65_or_older, .after = Age_65_or_older)
# Create longer version, for plotting
fda_approvals_long <- pivot_longer(fda_approvals, cols = Female:Age_80_or_older, names_to = "Demographic", values_to = "Percentage")
# Change class type of variable in long
fda_approvals_long$Percentage <- as.numeric(as.character(fda_approvals_long$Percentage))
# Make 15-19 dataset
approvals_15_19 <- fda_approvals %>% filter(Approval_Year != 2020)
## Account for missing data. Capture % representation of each demographic only in trials where that demographic is captured
# Race
global_black_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Black) %>%
filter(Black != "NA") %>%
mutate(Black_participants = (Black/100) * Enrollment)
global_white_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, White) %>%
filter(White != "NA") %>%
mutate(White_participants = (White/100) * Enrollment)
global_asian_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Asian) %>%
filter(Asian != "NA") %>%
mutate(Asian_participants = (Asian/100) * Enrollment)
race_participation <- c(round(sum(100 * global_asian_participation$Asian_participants) /
sum(global_asian_participation$Enrollment), 0),
round(sum(100 * global_black_participation$Black_participants) /
sum(global_black_participation$Enrollment), 0),
round(sum(100 * global_white_participation$White_participants) /
sum(global_white_participation$Enrollment), 0))
races <- c("Asian", "Black", "White")
race_participation <- data.frame("Race", races, race_participation)
names(race_participation) <- c("Demographic", "Category", "Value")
# Sex
global_female_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Female) %>%
filter(Female != "NA") %>%
mutate(Female_participants = (Female/100) * Enrollment)
global_male_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Male) %>%
filter(Male != "NA") %>%
mutate(Male_participants = (Male/100) * Enrollment)
sex_participation <- c(round(sum(100 * global_female_participation$Female_participants) /
sum(global_female_participation$Enrollment), 0),
round(sum(100 * global_male_participation$Male_participants) /
sum(global_male_participation$Enrollment), 0))
sexes <- c("Female", "Male")
sex_participation <- data.frame("Sex", sexes, sex_participation)
names(sex_participation) <- c("Demographic", "Category", "Value")
# Age
global_Age_under_65_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Age_under_65) %>%
filter(Age_under_65 != "NA") %>%
mutate(Age_under_65_participants = (Age_under_65/100) * Enrollment)
global_Age_65_or_older_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Age_65_or_older) %>%
filter(Age_65_or_older != "NA") %>%
mutate(Age_65_or_older_participants = (Age_65_or_older/100) * Enrollment)
age_participation <- c(round(sum(100 * global_Age_under_65_participation$Age_under_65_participants) /
sum(global_Age_under_65_participation$Enrollment), 0),
round(sum(100 * global_Age_65_or_older_participation$Age_65_or_older_participants) /
sum(global_Age_65_or_older_participation$Enrollment), 0))
ages <- c("Age_under_65", "Age_65_or_older")
age_participation <- data.frame("Age", ages, age_participation)
names(age_participation) <- c("Demographic", "Category", "Value")
# Combine the tables
demographic_participation <- rbind(age_participation, sex_participation, race_participation)
#fda_approvals <- fda_approvals %>% mutate(Age_under_65 = 100 - Age_65_or_older, .after = Age_65_or_older)
View(demographic_participation)
Race_distribution_comparison_graph <- Race_participation %>%
pivot_longer(cols = Value, names_to = "Database", values_to = "Participation") %>%
ggplot(aes(Race, Participation, width = 0.5)) + #, fill = Database)) +
geom_bar(stat = "identity", position = 'dodge') +
geom_text(aes(label=Participation), position = position_dodge(0.9), vjust=-0.3, size=6) +
ylim(0,100) +
xlab("Race") +
ylab("Participation") +
#theme(text = element_text(size=15), axis.text.x = element_text(size=15)) +
theme(axis.title.x=element_text(size=12, face="bold"), axis.title.y=element_text(size=12, face="bold")) +
ggtitle("Race distribution of trial participants")
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(~Demographic)
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(~Demographic, space = "free")
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(~Demographic, scales = "free", space = "free")
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(set ~ Demographic, scales = "free", space = "free")
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(~Demographic, drop = TRUE)
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(~Demographic, scales = "free", space = "free")
library(ggplot2)
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(~Demographic, scales = "free", space = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(~Demographic, scales = "free", space = "free")
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_bar() +
facet_wrap(~Demographic, scales = "free", space = "free")
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_bar() +
facet_wrap(~Demographic)#, scales = "free", space = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category)) +
geom_bar() +
facet_wrap(~Demographic)#, scales = "free", space = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(~Demographic, scales = "free", space = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col(stat='identity') +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
scale_y_continuous(breaks = round(seq(min(0), max(100), by = 20),1)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
scale_y_continuous(breaks = round(seq(min(0), max(100), by = 20),1)) +
expand_limits(y=c(0, 100)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col() +
expand_limits(y=c(0, 100)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col(width = 0.5) +
expand_limits(y=c(0, 100)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col(width = 0.5) +
geom_text(aes(label = Value)) +
expand_limits(y=c(0, 100)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
runApp()
runApp()
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col(width = 0.5) +
geom_text(aes(label = Value), position = position_dodge(0.9), hjust=-0.2, size=4) +
expand_limits(y=c(0, 100)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col(width = 0.5) +
geom_text(aes(label = Value), position = position_dodge(0.9), vjust=-0.2, size=4) +
expand_limits(y=c(0, 100)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col(width = 0.5) +
geom_text(aes(label = Value), position = position_dodge(0.9), vjust=-0.2, size=3) +
expand_limits(y=c(0, 100)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col(width = 0.5) +
geom_text(aes(label = Value), position = position_dodge(0.9), vjust=-0.4, size=3) +
expand_limits(y=c(0, 100)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
demographic_participation_graph <- demographic_participation %>%
ggplot(aes(x = Category, y = Value)) +
geom_col(width = 0.5) +
geom_text(aes(label = Value), position = position_dodge(0.9), vjust=-0.4, size=4) +
expand_limits(y=c(0, 100)) +
facet_wrap(~Demographic, scales = "free")
demographic_participation_graph
View(global_black_participation)
View(global_Age_under_65_participation)
all_enrolled <- sum(approvals_15_19$Enrollment)
hispanic_enrolled <- sum(global_Hispanic_participation / all_enrolled)
hispanic_enrolled <- sum(global_Hispanic_participation$Hispanic_participants / all_enrolled)
global_Hispanic_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Hispanic) %>%
filter(Hispanic != "NA") %>%
mutate(Hispanic_participants = (Hispanic/100) * Enrollment)
global_Non_Hispanic_participation <- approvals_15_19 %>%
select(Brand_Name, Enrollment, Non_Hispanic) %>%
filter(Non_Hispanic != "NA") %>%
mutate(Non_Hispanic_participants = (Non_Hispanic/100) * Enrollment)
all_enrolled <- sum(approvals_15_19$Enrollment)
hispanic_enrolled <- sum(global_Hispanic_participation$Hispanic_participants / all_enrolled)
non_hispanic_enrolled <- sum(global_Non_Hispanic_participationNon_Hispanic_participants / all_enrolled)
non_hispanic_enrolled <- sum(global_Non_Hispanic_participation$Non_Hispanic_participants / all_enrolled)
